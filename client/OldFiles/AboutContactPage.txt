import React, { useEffect, useRef, useState } from "react";
import { useNavigate } from "react-router-dom";
import { useSplash } from "../context/SplashContext";
import Footer from "../components/Footer";
import { Plus, ArrowRight } from "lucide-react";

// Re-usable FAQ Item component
const FAQItem = ({ question, answer }) => {
  const [isOpen, setIsOpen] = useState(false);
  return (
    <div className="border-b border-gray-300 py-4">
      <button
        className="flex justify-between items-center w-full text-lg font-medium text-gray-800 hover:text-indigo-600 transition-colors duration-200 text-left"
        onClick={() => setIsOpen(!isOpen)}
      >
        {question}
        <Plus className={`h-5 w-5 min-w-[20px] transition-transform duration-300 ${isOpen ? 'rotate-45 text-indigo-600' : ''}`} />
      </button>
      {isOpen && (
        <p className="mt-2 text-gray-600 text-base leading-relaxed animate-fadeIn">
          {answer}
        </p>
      )}
    </div>
  );
};

const AboutContactPage = () => {
  const { showSplash } = useSplash();
  const navigate = useNavigate();
  const containerRef = useRef(null);
  
  // Create a ref specifically for the contact section wrapper to calculate its index scroll position
  const contactScrollTrigger = 4; // Contact is the 5th item (Index 4)

  const [vh, setVh] = useState(window.innerHeight);
  const [formData, setFormData] = useState({ name: "", email: "", message: "" });

  // ‚úÖ 1. Update viewport height dynamically
  useEffect(() => {
    const onResize = () => setVh(window.innerHeight);
    window.addEventListener("resize", onResize);
    return () => window.removeEventListener("resize", onResize);
  }, []);

  // ‚úÖ 2. Track scroll progress
  useEffect(() => {
    const onScroll = () => {
      const scrollY = window.scrollY || window.pageYOffset;
      const progress = scrollY / vh;
      if (containerRef.current) {
        containerRef.current.style.setProperty("--scroll", progress);
      }
    };
    window.addEventListener("scroll", onScroll, { passive: true });
    return () => window.removeEventListener("scroll", onScroll);
  }, [vh]);

  // ‚úÖ 3. Form Handlers
  const handleChange = (e) => {
    const { name, value } = e.target;
    setFormData((prev) => ({ ...prev, [name]: value }));
  };

  const handleSubmit = (e) => {
    e.preventDefault();
    showSplash(
      2500,
      () => {
        alert("üì® Message sent successfully!");
        setFormData({ name: "", email: "", message: "" });
      },
      "üì® Sending your message..."
    );
  };

  // ‚úÖ 4. Scroll to Contact Logic
  // Since we are using virtual scroll based on height, we scroll the WINDOW to the calculated point
  const handleScrollToContact = () => {
    window.scrollTo({
      top: contactScrollTrigger * window.innerHeight,
      behavior: "smooth",
    });
  };

  return (
    <div
      ref={containerRef}
      className="relative w-full bg-transparent overflow-x-hidden font-['Wix_Madefor_Text']"
      // Height = Number of sections (6) * 100vh + buffer
      style={{ height: "650vh" }}
    >
      
      {/* ========================================================= */}
      {/* 1Ô∏è‚É£ ABOUT US SECTION (Index 0) - Base Layer */}
      {/* ========================================================= */}
      {/* No transform needed, it sits at the bottom of the stack (Z-10) */}
      <div className="fixed inset-0 z-10 bg-white">
        <section className="h-full w-full flex flex-col md:flex-row items-center justify-between px-6 md:px-20 py-10 md:py-0">
            <div className="flex flex-col md:flex-row w-full items-center md:items-start justify-between gap-10 md:gap-16">
            <div className="flex-1 text-center md:text-left space-y-4 max-w-xl">
                <h1 className="text-4xl md:text-6xl font-bold text-black leading-tight">
                About FolioFYX
                </h1>
                <p className="text-gray-800 text-base md:text-lg leading-relaxed">
                Welcome to{" "}
                <span className="font-semibold text-[#0d0d82]">FolioFYX Studio</span> ‚Äî a creative workspace where **design meets technology**.
                <br className="hidden md:block" />
                Our mission is to simplify portfolio creation with **elegance and precision**.
                Whether you‚Äôre a student, artist, or entrepreneur, FolioFYX lets your story
                unfold beautifully through intelligent, modern design.
                </p>
            </div>

            <div className="flex-1 grid grid-cols-1 sm:grid-cols-2 gap-4 w-full max-w-2xl">
                {/* Studio Card */}
                <div className="relative bg-black p-4 sm:p-6 rounded-3xl shadow-lg hover:scale-[1.02] transition-transform duration-300 mx-auto w-full max-w-sm">
                <img
                    src="/studio.png"
                    alt="FolioFYX Studio"
                    className="rounded-2xl object-cover w-full h-auto"
                />
                <button
                    onClick={() =>
                    showSplash(2000, () => navigate("/create"), " Setting up your studio...")
                    }
                    className="absolute bottom-4 right-4 sm:bottom-6 sm:right-6 border border-[#0d0d82] bg-white text-[#0d0d82] px-4 sm:px-5 py-1.5 sm:py-2 rounded-full text-xs sm:text-sm hover:bg-[#0d0d82] hover:text-white transition-all duration-300"
                >
                    Get Started
                </button>
                </div>

                {/* Themes Card */}
                <div className="bg-[#cfd5ff] p-6 sm:p-8 rounded-3xl shadow-md hover:scale-[1.02] transition-transform duration-300 mx-auto w-full max-w-sm">
                <h3 className="text-lg sm:text-xl font-semibold mb-3 text-center sm:text-left">
                    FolioFYX Themes
                </h3>
                <p className="text-sm sm:text-base text-gray-700 mb-6 leading-relaxed text-center sm:text-left">
                    Discover a collection of AI-curated portfolio themes ‚Äî from{" "}
                    <span className="font-medium text-[#0d0d82]">Minimal</span> to{" "}
                    <span className="font-medium text-[#0d0d82]">Professional</span>.
                    Each theme **highlights your work** and adapts seamlessly.
                </p>
                <div className="flex justify-center sm:justify-start">
                    <button
                    onClick={handleScrollToContact}
                    className="border border-[#0d0d82] text-[#0d0d82] px-4 sm:px-5 py-1.5 sm:py-2 rounded-full text-sm hover:bg-[#0d0d82] hover:text-white transition-all duration-300"
                    >
                    Contact Us
                    </button>
                </div>
                </div>
            </div>
            </div>

            {/* Signature */}
            <p className="absolute bottom-10 left-1/2 -translate-x-1/2 text-xs sm:text-sm text-[#0d0d82] uppercase tracking-[0.25em]">
            A <span className="text-[#6C63FF] font-bold">Prateek‚Ñ¢</span> Product ‚Äî Where ideas meet passion.
            </p>
        </section>
      </div>

      {/* ========================================================= */}
      {/* 2Ô∏è‚É£ FEATURES SECTION (Index 1) - Slides over About */}
      {/* ========================================================= */}
      <div 
        className="fixed inset-0 z-20 bg-white"
        style={{ transform: `translateY(calc(max(0px, (1 - var(--scroll, 0)) * 100vh)))` }}
      >
        <section className="h-full w-full flex items-center justify-center">
            <div className="max-w-7xl mx-auto px-6 py-16 text-black w-full">
            <div className="flex flex-col md:flex-row justify-between items-start mb-12">
                <div className="md:w-1/2 text-center md:text-left">
                <h2 className="text-4xl md:text-5xl font-bold leading-tight mb-4">
                    Grow your website on a **rock-solid foundation**
                </h2>
                </div>
                <div className="md:w-1/2 text-center md:text-left md:pl-10 mt-6 md:mt-0">
                <p className="text-gray-700 text-lg mb-6">
                    Set your site up for success on the powerful infrastructure that supports millions of websites worldwide.
                </p>
                <button
                    onClick={() => showSplash(2000, () => navigate("/get-started"), "Starting your journey...")}
                    className="bg-black text-white px-8 py-4 rounded-xl text-lg font-semibold hover:bg-gray-800 transition-colors duration-300"
                >
                    Get Started
                </button>
                </div>
            </div>

            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                <div className="bg-[#0b363a] text-white p-8 rounded-2xl min-h-[250px] flex flex-col justify-end">
                <h3 className="text-xl font-semibold mb-2">Engineered for top speed</h3>
                <p className="text-gray-200 text-sm">FolioFYX sites are designed to ensure **fast loading times**.</p>
                </div>
                <div className="bg-[#ffe0fd] text-gray-800 p-8 rounded-2xl min-h-[250px] flex flex-col justify-end">
                <h3 className="text-xl font-semibold mb-2">Designed for accessibility</h3>
                <p className="text-gray-700 text-sm">Build an **inclusive site** that everyone can interact with.</p>
                </div>
                <div className="bg-[#e0ffe0] text-gray-800 p-8 rounded-2xl min-h-[250px] flex flex-col justify-end">
                <h3 className="text-xl font-semibold mb-2">Secured by industry experts</h3>
                <p className="text-gray-700 text-sm">Get **enterprise-grade security** against threats.</p>
                </div>
                <div className="bg-[#783e33] text-white p-8 rounded-2xl min-h-[250px] flex flex-col justify-end">
                <h3 className="text-xl font-semibold mb-2">Built with reliability in mind</h3>
                <p className="text-gray-200 text-sm">Multi-cloud hosting ensures **99.99% uptime**.</p>
                </div>
            </div>
            </div>
        </section>
      </div>

      {/* ========================================================= */}
      {/* 3Ô∏è‚É£ SUPPORT SECTION (Index 2) - Slides over Features */}
      {/* ========================================================= */}
      <div 
        className="fixed inset-0 z-30 bg-[#17212e] text-white rounded-t-[60px]"
        style={{ transform: `translateY(calc(max(0px, (2 - var(--scroll, 0)) * 100vh)))` }}
      >
        <section className="h-full w-full flex items-center justify-center">
            <div className="max-w-4xl mx-auto px-6 py-16 w-full">
            <h2 className="text-4xl md:text-5xl font-bold mb-12 text-center md:text-left">We're here for you **24/7**</h2>

            <div className="space-y-6">
                <div className="bg-[#2a374a] p-6 rounded-2xl flex items-center justify-between hover:bg-[#3d4c63] transition-colors duration-300 cursor-pointer border border-[#3d4c63]">
                <div className="flex-1">
                    <h3 className="text-xl font-semibold mb-1">Get answers</h3>
                    <p className="text-gray-300 text-sm">Ask anything and get quick answers in the **FolioFYX Help Center**.</p>
                </div>
                <ArrowRight className="h-6 w-6 text-gray-400 ml-4" />
                </div>
                <div className="bg-[#2a374a] p-6 rounded-2xl flex items-center justify-between hover:bg-[#3d4c63] transition-colors duration-300 cursor-pointer border border-[#3d4c63]">
                <div className="flex-1">
                    <h3 className="text-xl font-semibold mb-1">Chat with us</h3>
                    <p className="text-gray-300 text-sm">Get 24/7 chat help from our Helpmate or contact a Customer Care Expert.</p>
                </div>
                <ArrowRight className="h-6 w-6 text-gray-400 ml-4" />
                </div>
                <div className="bg-[#2a374a] p-6 rounded-2xl flex items-center justify-between hover:bg-[#3d4c63] transition-colors duration-300 cursor-pointer border border-[#3d4c63]">
                <div className="flex-1">
                    <h3 className="text-xl font-semibold mb-1">Hire a pro</h3>
                    <p className="text-gray-300 text-sm">Get help at any stage‚Äîfrom site creation to online growth.</p>
                </div>
                <ArrowRight className="h-6 w-6 text-gray-400 ml-4" />
                </div>
            </div>
            </div>
        </section>
      </div>

      {/* ========================================================= */}
      {/* 4Ô∏è‚É£ WHO WE ARE (Index 3) - Slides over Support */}
      {/* ========================================================= */}
      <div 
        className="fixed inset-0 z-40 bg-[#E5DCFF] text-[#1A237E] rounded-t-[60px]"
        style={{ transform: `translateY(calc(max(0px, (3 - var(--scroll, 0)) * 100vh)))` }}
      >
        <section className="h-full w-full flex items-center justify-center">
            <div className="max-w-6xl mx-auto grid grid-cols-1 md:grid-cols-2 gap-12 items-center px-8 w-full">
            <div>
                <img
                src="/logofyx3.png"
                alt="About FolioFYX"
                className="rounded-4xl shadow-xl p-4 bg-black w-[350px] md:w-[450px] object-cover mx-auto"
                />
                <button
                onClick={handleScrollToContact}
                className="bg-gradient-to-r from-purple-600 via-fuchsia-500 to-indigo-600 hover:opacity-95 mt-8 text-white px-6 py-3 rounded-full shadow-md transition-transform duration-300 hover:scale-105 mx-auto block"
                >
                Get Connected
                </button>
            </div>

            <div className="text-center md:text-left">
                <h2 className="text-4xl font-bold mb-4">Who is Behind FolioFYX?</h2>
                <p className="text-gray-700 mb-4 text-lg">
                FolioFYX was founded by **Prateek Koratala** with one clear mission ‚Äî to empower creators,
                designers, and professionals with the easiest and most elegant way
                to build their online presence.
                </p>
                <p className="text-gray-700 mb-6 text-lg">
                Prateek is the **Designer, Developer, and Founder**, bringing a passion for clean UI/UX and robust engineering. The platform is a direct result of solving the clutter and limitations found in other builders.
                </p>
                <div className="mt-10">
                <p className="text-[#0d0d82] font-semibold text-lg">Prateek Koratala</p>
                <p className="text-gray-600 text-sm">
                    Founder | Designer | Developer
                </p>
                </div>
            </div>
            </div>
        </section>
      </div>

      {/* ========================================================= */}
      {/* 5Ô∏è‚É£ CONTACT SECTION (Index 4) - Slides over Who We Are */}
      {/* ========================================================= */}
      <div 
        className="fixed inset-0 z-50 rounded-t-[60px] overflow-hidden" 
        style={{ transform: `translateY(calc(max(0px, (4 - var(--scroll, 0)) * 100vh)))` }}
      >
        {/* --- START VIDEO BACKGROUND --- */}
        <video
            autoPlay
            loop
            muted
            playsInline
            className="absolute inset-0 w-full h-full object-cover"
        >
            {/* ‚ö†Ô∏è REPLACE THIS with your actual video path */}
            <source src="/v10.mp4" type="video/mp4" />
        </video>

        {/* Dark overlay to make text readable over video */}
        <div className="absolute inset-0 bg-black/40"></div>
        {/* --- END VIDEO BACKGROUND --- */}

        {/* Content Section (z-10 puts it above the video) */}
        <section className="relative z-10 h-full w-full flex flex-col items-center justify-center text-white">
            <div className="max-w-3xl w-full text-center px-6">
            <h2 className="text-4xl font-bold mb-3 drop-shadow-md">Get in Touch</h2>
            <p className="text-gray-100 mb-8 drop-shadow-md">
                Have a question, feedback, or collaboration idea? We‚Äôd love to hear from you.
            </p>

            <form
                onSubmit={handleSubmit}
                className="bg-white rounded-3xl p-8 shadow-xl text-left relative overflow-hidden"
            >
                {/* Decorative background circles inside form */}
                <div className="absolute -top-10 -left-10 w-32 h-32 bg-indigo-200 opacity-20 rounded-full mix-blend-multiply animate-blob filter blur-xl"></div>
                <div className="absolute -bottom-10 -right-10 w-48 h-48 bg-fuchsia-200 opacity-20 rounded-full mix-blend-multiply animation-delay-2000 animate-blob filter blur-xl"></div>
                <div className="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-40 h-40 bg-purple-200 opacity-20 rounded-full mix-blend-multiply animation-delay-4000 animate-blob filter blur-xl"></div>

                <div className="grid grid-cols-1 sm:grid-cols-2 gap-6 relative z-10">
                <input
                    type="text"
                    name="name"
                    placeholder="Your Name"
                    value={formData.name}
                    onChange={handleChange}
                    required
                    className="p-4 rounded-xl border border-gray-300 focus:border-indigo-500 outline-none text-gray-800"
                />
                <input
                    type="email"
                    name="email"
                    placeholder="Your Email"
                    value={formData.email}
                    onChange={handleChange}
                    required
                    className="p-4 rounded-xl border border-gray-300 focus:border-indigo-500 outline-none text-gray-800"
                />
                </div>

                <textarea
                name="message"
                rows="5"
                placeholder="Your Message"
                value={formData.message}
                onChange={handleChange}
                required
                className="w-full p-4 mt-6 rounded-xl border border-gray-300 focus:border-indigo-500 outline-none text-gray-800"
                ></textarea>

                <button
                type="submit"
                className="relative mt-6 flex items-center justify-center gap-2 bg-gradient-to-r from-indigo-600 via-fuchsia-500 to-purple-600 text-white px-8 py-3 rounded-full shadow-lg hover:opacity-95 transition-transform duration-300 hover:scale-105 overflow-hidden w-full sm:w-auto mx-auto"
                >
                <span className="relative z-10">Send Message</span>
                <span className="absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent translate-x-[-100%] animate-shine"></span>
                </button>
            </form>
            </div>
        </section>
      </div>

      {/* ========================================================= */}
      {/* 6Ô∏è‚É£ FAQ + FOOTER SECTION (Index 5) - Slides over Contact */}
      {/* ========================================================= */}
      <div 
        className="fixed inset-0 z-[60] bg-[#fefefe] text-gray-900 rounded-t-[60px]"
        style={{ transform: `translateY(calc(max(0px, (5 - var(--scroll, 0)) * 100vh)))` }}
      >
        <section className="h-full w-full flex flex-col items-center justify-start pt-20 overflow-y-auto">
            <div className="max-w-4xl w-full px-6 mb-12 flex-grow">
            <h2 className="text-4xl font-bold mb-8 text-center md:text-left">Website Builder FAQ</h2>
            <div className="space-y-2">
                <FAQItem
                question="Is it easy to build a website with FolioFYX?"
                answer="Yes! FolioFYX is designed for simplicity and ease of use. Our intuitive interface and AI-powered tools help you create a stunning portfolio in minutes, no coding required."
                />
                <FAQItem
                question="How do I create a website?"
                answer="Simply choose a theme, upload your work, and customize your content. Our guided process makes it straightforward to build and launch your professional online portfolio."
                />
                <FAQItem
                question="How do I choose the best website builder?"
                answer="The best builder depends on your needs. FolioFYX excels for those seeking elegant, professional portfolios with minimal fuss, strong visual appeal, and great accessibility features."
                />
                <FAQItem
                question="What types of websites can you build on FolioFYX?"
                answer="FolioFYX is optimized for professional portfolios‚Äîfor artists, designers, developers, writers, and any professional showcasing their work. It‚Äôs also great for personal branding sites."
                />
                <FAQItem
                question="What makes a good website?"
                answer="A good website is fast, accessible, visually appealing, easy to navigate, and effectively communicates its purpose. FolioFYX helps you achieve all these crucial elements effortlessly."
                />
            </div>
            </div>

            <div className="w-full">
                <div className="bg-black text-white pt-20 pb-4">
                <div className="max-w-7xl mx-auto px-6">
                    <p className="text-center text-xs text-[#E5DCFF] uppercase tracking-[0.25em] mb-4">
                        A <span className="text-[#6C63FF] font-bold">PRATEEK‚Ñ¢</span> PRODUCT ‚Äî WHERE IDEAS MEET PASSION.
                    </p>
                    <Footer />
                </div>
                </div>
            </div>
        </section>
      </div>

      {/* ============================ */}
      {/* üîÆ Animations & Styles */}
      {/* ============================ */}
      <style>{`
        :root { --scroll: 0; }

        @keyframes shine {
          from { transform: translateX(-100%); }
          to { transform: translateX(100%); }
        }
        .animate-shine {
          animation: shine 2s linear infinite;
        }

        @keyframes blob {
          0% { transform: translate(0, 0) scale(1); }
          33% { transform: translate(30px, -50px) scale(1.1); }
          66% { transform: translate(-20px, 20px) scale(0.9); }
          100% { transform: translate(0, 0) scale(1); }
        }
        .animate-blob {
          animation: blob 7s infinite cubic-bezier(0.62, 0.28, 0.23, 0.99);
        }
        .animation-delay-2000 { animation-delay: 2s; }
        .animation-delay-4000 { animation-delay: 4s; }

        @keyframes fadeIn {
          from { opacity: 0; transform: translateY(-10px); }
          to { opacity: 1; transform: translateY(0); }
        }
        .animate-fadeIn {
          animation: fadeIn 0.5s ease-out forwards;
        }
      `}</style>
    </div>
  );
};

export default AboutContactPage;